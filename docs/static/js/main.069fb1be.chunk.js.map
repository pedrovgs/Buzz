{"version":3,"sources":["theme/AppTheme.js","app/routes.js","app/actions.js","session/actions.js","session/session.js","baseComponents/logo/images/logo.svg","baseComponents/logo/Logo.js","testUtils/utils.js","baseComponents/progressBar/ProgressBar.js","animations/animationUtils.js","splashScreen/SplashScreen.js","firebase/firebaseAuth.js","baseComponents/signInForm/SignInForm.js","session/LogInScreen.js","baseComponents/floatingButton/FloatingButton.js","baseComponents/navigationBar/NavigationBar.js","firebase/firebaseStorage.js","album/actions.js","utils/dates.js","album/emptyCase/EmptyAlbum.js","album/AlbumScreen.js","baseComponents/webcam/WebCam.js","baseComponents/countdown/Countdown.js","camera/actions.js","camera/CameraScreen.js","preview/PreviewScreen.js","detail/DetailScreen.js","app/App.js","persistence/storePersistence.js","camera/camera.js","album/album.js","app/buzz.js","index.js"],"names":["AppTheme","getMuiTheme","fontFamily","palette","primary1Color","primary2Color","accent1Color","accent2Color","textColor","alternateTextColor","LOG_IN","ALBUM","CAMERA","PREVIEW","DETAIL","RESET_STATE","resetState","state","type","SAVE_SESSION","LOG_OUT","User","uid","email","this","logOut","history","dispatch","replace","initialState","user","undefined","authToken","sessionReducer","action","Object","assign","isUserLoggedIn","session","getFolderId","mediumSize","bigStyle","width","height","padding","mediumStyle","Logo","componentStyle","getComponentStyle","id","src","logo","alt","style","props","size","React","Component","isRunningTests","runningTestEnvVar","process","REACT_APP_RUNNING_TESTS","Boolean","ProgressBar","hidden","mode","testUtils","value","defaultProps","fade","component","transitionName","transitionAppear","transitionAppearTimeout","transitionEnterTimeout","transitionLeaveTimeout","Splash","loading","showLoadingTimer","setTimeout","showLoading","clearTimeout","hideLoadingTimer","center","middle","className","getMainComponent","scheduleHideLoading","openNextScreen","push","setState","withRouter","connect","signOut","firebase","auth","signIn","pass","signInWithEmailAndPassword","signUp","password","createUserWithEmailAndPassword","currentUser","isLogInInProgress","errorMessage","formStyle","buttonStyle","margin","SignInForm","onEmailFieldChanged","bind","onPasswordFieldChanged","onSubmit","floatingLabelText","disabled","onChange","errorText","label","onClick","event","newValue","preventDefault","setStateToLogInInProgress","signInOrSignUpIfTheUserAlreadyExists","firebaseAuth","then","notifyLogInSuccess","catch","error","errorCode","code","createAccount","setStateToError","message","onUserLoggedIn","logInInProgress","LogInScreen","goToAlbumScreenIfTheUserIsStillLoggedIn","saveSession","onError","actionButtonStyle","position","right","bottom","FloatingButton","children","userEmailLabelStyle","textTransform","NavigationBar","onLeftIconButtonClick","onLogOutButtonClick","closeDialog","handleLogOutOkButtonClick","showLogOutDialog","logOutDialogActions","primary","keyboardFocused","title","actions","modal","open","iconElementLeft","leftIcon","showMenuIconButton","showBackButton","iconElementRight","userLoggedInEmail","labelStyle","goBack","uploadBase64Image","folderName","image","storageRef","storage","ref","timestamp","moment","unix","fileExtension","childRef","child","putString","getDownloadURL","resourceUrl","pictureUrl","substring","indexOf","length","folder","childId","extractReferenceId","reference","database","newKey","key","updates","url","createdAt","valueOf","update","addPictureToTheDatabase","split","join","FETCH_PICTURES","PICTURES_LOADED","SELECT_PICTURE","DELETE_PICTURE","DELETING_PICTURE","fetchPictures","getState","folderId","orderByChild","once","result","firebaseObject","val","keys","map","storedObject","reverse","pictures","selectPicture","pictureSelected","deletePicture","pictureToDelete","remove","formatTimestamp","jsDate","Date","format","contentStyle","icon","color","text","fontSize","EmptyAlbum","role","styles","gridList","overflowY","img","minWidth","minHeight","transform","left","top","AlbumScreen","onFloatingButtonClick","onPictureClick","containerStyle","fetchingPictures","renderMainComponent","xs","cols","numberOfColumns","cellHeight","tile","document","documentElement","requestFullscreen","webkitRequestFullscreen","Number","album","sendPictureEmail","videoStyle","zIndex","WebCam","video","getVideoTag","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","oGetUserMedia","constraints","audio","ideal","facingMode","mediaDevices","enumerateDevices","devices","i","kind","deviceId","exact","stream","localStream","srcObject","getTracks","stop","pause","autoPlay","querySelector","canvas","createElement","videoHeight","videoWidth","ctx","getContext","scale","drawImage","toDataURL","background","counterStyle","Countdown","countdownValue","countdownSeconds","countdownFinished","prevProps","wasTheStartDateConfiguredRecently","shouldStopTheCountdown","onCountdownFinished","updateCounterValue","didStartTheCountdown","countdownTimer","countdownStartDate","now","secondsSinceStart","diff","Math","abs","SAVE_TENTATIVE_PICTURE","UPLOAD_PICTURE","PICTURE_UPLOADED","uploadPicture","base64Picture","pictureUploaded","CameraScreen","didFinishCountdown","webcamReference","createRef","prevProp","prevState","tentativePicture","startCountdownDate","base64Image","current","takePicture","onPictureTaken","camera","picture","previewStyle","PreviewScreen","mountDate","previewFinished","dismissDelay","timeoutDelay","max","lastPictureUploaded","DetailScreen","updateDimensions","onNewPictureSelected","window","innerWidth","innerHeight","addEventListener","removeEventListener","selectedPicture","images","original","items","lazyLoad","showFullscreenButton","showThumbnails","slideInterval","onSlide","index","deletingPicture","dots","infinite","speed","slidesToShow","slidesToScroll","adaptiveHeight","autoplay","autoplaySpeed","initialSlide","onPictureSelected","onPictureDeleted","albumState","App","HashRouter","Route","path","SplashScreen","stateKey","a","Promise","resolve","store","get","uploadingPicture","cameraReducer","albumReducer","newSelectedPicture","filter","newSelectedPictureIndex","buzzStore","createStore","__REDUX_DEVTOOLS_EXTENSION__","applyMiddleware","thunk","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","loadState","loadInitialState","saveNewStatus","currentState","set","persistStateThrottle","subscribe","throttle","configureSubscriberToPersistStateChanges","configurePersistence","WebFont","load","google","families","ReactDOM","render","muiTheme","getElementById"],"mappings":"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","file":"static/js/main.069fb1be.chunk.js","sourcesContent":["import getMuiTheme from \"material-ui/styles/getMuiTheme\";\n\nconst AppTheme = getMuiTheme({\n  fontFamily: \"Roboto, sans-serif\",\n  palette: {\n    primary1Color: \"#f2db2c\",\n    primary2Color: \"#33658a\",\n    accent1Color: \"#bbaa00\",\n    accent2Color: \"#003b5d\",\n    textColor: \"#000000\",\n    alternateTextColor: \"#ffffff\"\n  }\n});\n\nexport default AppTheme;\n","export const INDEX = \"/\";\nexport const LOG_IN = \"/logIn\";\nexport const ALBUM = \"/album\";\nexport const CAMERA = \"/camera\";\nexport const PREVIEW = \"/preview\";\nexport const DETAIL = \"/detail\";\n","export const RESET_STATE = \"RESET_STATE\";\n\nexport function resetState(state = {}) {\n  return {\n    type: RESET_STATE,\n    state: state\n  };\n}\n","import { INDEX } from \"../app/routes\";\nimport { resetState } from \"../app/actions\";\n\nexport const SAVE_SESSION = \"SAVE_SESSION\";\nexport const LOG_OUT = \"LOG_OUT\";\n\nexport class User {\n  constructor(uid, email) {\n    this.uid = uid;\n    this.email = email;\n  }\n}\n\nexport function saveSession(user) {\n  return {\n    type: SAVE_SESSION,\n    user: user\n  };\n}\n\nexport function logOut(history) {\n  return function(dispatch) {\n    dispatch({\n      type: LOG_OUT\n    });\n    dispatch(resetState());\n    history.replace(INDEX);\n  };\n}\n","import { SAVE_SESSION, LOG_OUT } from \"./actions\";\n\nconst initialState = {\n  user: undefined,\n  authToken: undefined\n};\n\nexport function sessionReducer(state = initialState, action) {\n  switch (action.type) {\n    case SAVE_SESSION:\n      return Object.assign({}, state, {\n        user: action.user\n      });\n    case LOG_OUT:\n      return initialState;\n    default:\n      return state;\n  }\n}\n\nexport function isUserLoggedIn(state) {\n  const isSessionDefined = typeof state.session !== \"undefined\";\n  if (isSessionDefined) {\n    const isUserDefined = typeof state.session.user !== \"undefined\";\n    return isUserDefined;\n  } else {\n    return false;\n  }\n}\n\nexport function getFolderId(state) {\n  const isSessionDefined =\n    typeof state.session !== \"undefined\" &&\n    typeof state.session.user !== \"undefined\";\n  if (isSessionDefined) {\n    return state.session.user.uid;\n  } else {\n    return undefined;\n  }\n}\n","export default __webpack_public_path__ + \"static/media/logo.e918f3e3.svg\";","import React from \"react\";\nimport logo from \"./images/logo.svg\";\nimport PropTypes from \"prop-types\";\n\nexport const mediumSize = \"medium\";\nexport const bigSize = \"big\";\n\nconst bigStyle = {\n  width: \"40%\",\n  height: \"40%\",\n  padding: \"12px\"\n};\n\nconst mediumStyle = {\n  width: \"25%\",\n  height: \"25%\",\n  padding: \"8px\"\n};\n\nclass Logo extends React.Component {\n  render() {\n    const componentStyle = this.getComponentStyle();\n    return <img id=\"logo\" src={logo} alt=\"Buzz logo\" style={componentStyle} />;\n  }\n\n  getComponentStyle() {\n    const configuredSize = this.props.size;\n    if (this.props.size === mediumSize) {\n      return mediumStyle;\n    } else if (configuredSize === bigSize) {\n      return bigStyle;\n    } else {\n      return bigStyle;\n    }\n  }\n}\n\nLogo.propTypes = {\n  size: PropTypes.string\n};\n\nexport default Logo;\n","function isRunningTests() {\n  const runningTestEnvVar = process.env.REACT_APP_RUNNING_TESTS;\n  return runningTestEnvVar ? Boolean(runningTestEnvVar) === true : false;\n}\n\nexport default {\n  isRunningTests: isRunningTests\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { CircularProgress } from \"material-ui\";\nimport testUtils from \"../../testUtils/utils\";\n\nclass ProgressBar extends React.Component {\n  render() {\n    if (this.props.hidden) {\n      return null;\n    } else {\n      const mode = testUtils.isRunningTests() ? \"determinate\" : \"indeterminate\";\n      return (\n        <CircularProgress id=\"progress\" mode={mode} size={100} value={55} />\n      );\n    }\n  }\n}\n\nProgressBar.propTypes = {\n  hidden: PropTypes.bool\n};\n\nProgressBar.defaultProps = {\n  hidden: false\n};\n\nexport default ProgressBar;\n","import React from \"react\";\nimport { CSSTransitionGroup } from \"react-transition-group\";\n\nimport testUtils from \"../testUtils/utils\";\n\nexport function fade(component) {\n  if (testUtils.isRunningTests()) {\n    return component;\n  }\n  return (\n    <CSSTransitionGroup\n      transitionName=\"fade\"\n      transitionAppear={true}\n      transitionAppearTimeout={500}\n      transitionEnterTimeout={500}\n      transitionLeaveTimeout={300}\n    >\n      {component}\n    </CSSTransitionGroup>\n  );\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { withRouter } from \"react-router\";\nimport { connect } from \"react-redux\";\nimport { ALBUM, LOG_IN } from \"../app/routes\";\nimport { isUserLoggedIn } from \"../session/session\";\nimport Logo, { bigSize } from \"../baseComponents/logo/Logo\";\nimport ProgressBar from \"../baseComponents/progressBar/ProgressBar\";\nimport { Row, Col } from \"react-flexbox-grid\";\nimport { fade } from \"../animations/animationUtils\";\n\nconst timeShowingAppIconInMillis = 1200;\nconst timeLoadingInMillis = 1900;\n\nclass Splash extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { loading: false };\n  }\n\n  componentDidMount() {\n    this.showLoadingTimer = setTimeout(\n      () => this.showLoading(),\n      timeShowingAppIconInMillis\n    );\n  }\n\n  componentWillUnmount() {\n    clearTimeout(this.showLoadingTimer);\n    clearTimeout(this.hideLoadingTimer);\n  }\n\n  render() {\n    return (\n      <Row center=\"xs\" middle=\"xs\" className=\"fullWidth\">\n        <Col>{fade(this.getMainComponent())}</Col>\n      </Row>\n    );\n  }\n\n  getMainComponent() {\n    if (this.state.loading) {\n      this.scheduleHideLoading();\n      return <ProgressBar />;\n    } else {\n      return <Logo size={bigSize} />;\n    }\n  }\n\n  scheduleHideLoading() {\n    this.hideLoadingTimer = setTimeout(\n      () => this.openNextScreen(),\n      timeLoadingInMillis\n    );\n  }\n\n  openNextScreen() {\n    if (this.props.isUserLoggedIn === false) {\n      return this.props.history.push(LOG_IN);\n    } else {\n      return this.props.history.push(ALBUM);\n    }\n  }\n\n  showLoading() {\n    this.setState({\n      loading: true\n    });\n  }\n}\n\nfunction mapStateToProps(state) {\n  return { isUserLoggedIn: isUserLoggedIn(state) };\n}\n\nSplash.propTypes = {\n  history: PropTypes.object.isRequired\n};\n\nexport default withRouter(connect(mapStateToProps)(Splash));\n","import firebase from \"firebase\";\n\nfunction signOut() {\n  return firebase.auth().signOut();\n}\n\nfunction signIn(email, pass) {\n  return firebase.auth().signInWithEmailAndPassword(email, pass);\n}\n\nfunction signUp(email, password) {\n  return firebase.auth().createUserWithEmailAndPassword(email, password);\n}\n\nfunction currentUser() {\n  return firebase.auth().currentUser;\n}\n\nexport default {\n  signOut: signOut,\n  signIn: signIn,\n  signUp: signUp,\n  currentUser: currentUser\n};\n","import React from \"react\";\nimport { TextField, RaisedButton } from \"material-ui\";\nimport { User } from \"../../session/actions\";\nimport firebaseAuth from \"../../firebase/firebaseAuth\";\n\nconst initialState = {\n  isLogInInProgress: false,\n  email: undefined,\n  password: undefined,\n  errorMessage: undefined\n};\n\nconst formStyle = {\n  padding: \"6px\"\n};\n\nconst buttonStyle = {\n  margin: 12\n};\n\nclass SignInForm extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = initialState;\n    this.onEmailFieldChanged = this.onEmailFieldChanged.bind(this);\n    this.onPasswordFieldChanged = this.onPasswordFieldChanged.bind(this);\n    this.onSubmit = this.onSubmit.bind(this);\n  }\n\n  render() {\n    const isLogInInProgress = this.state.isLogInInProgress;\n    return (\n      <form style={formStyle} id=\"signInForm\">\n        <div>\n          <TextField\n            id=\"emailField\"\n            floatingLabelText=\"Email\"\n            disabled={isLogInInProgress}\n            onChange={this.onEmailFieldChanged}\n            errorText={this.state.errorMessage}\n          />\n        </div>\n        <div>\n          <TextField\n            id=\"passwordField\"\n            type=\"password\"\n            floatingLabelText=\"Password\"\n            disabled={isLogInInProgress}\n            onChange={this.onPasswordFieldChanged}\n          />\n        </div>\n        <div>\n          <RaisedButton\n            id=\"signUpButton\"\n            label=\"Sign Up\"\n            style={buttonStyle}\n            disabled={isLogInInProgress}\n            onClick={this.onSubmit}\n          />\n          <RaisedButton\n            id=\"signInButton\"\n            label=\"Sign In\"\n            style={buttonStyle}\n            disabled={isLogInInProgress}\n            onClick={this.onSubmit}\n          />\n        </div>\n      </form>\n    );\n  }\n\n  onEmailFieldChanged(event, newValue) {\n    this.setState(() => ({\n      email: newValue\n    }));\n  }\n\n  onPasswordFieldChanged(event, newValue) {\n    this.setState(() => ({\n      password: newValue\n    }));\n  }\n\n  onSubmit(event) {\n    if (event) {\n      event.preventDefault();\n    }\n    this.setStateToLogInInProgress(true);\n    return this.signInOrSignUpIfTheUserAlreadyExists();\n  }\n\n  signInOrSignUpIfTheUserAlreadyExists() {\n    const email = this.state.email;\n    const pass = this.state.password;\n    return firebaseAuth.signOut().then(() => {\n      return firebaseAuth\n        .signIn(email, pass)\n        .then(() => {\n          this.notifyLogInSuccess();\n        })\n        .catch(error => {\n          let errorCode = error.code;\n          if (errorCode === \"auth/user-not-found\") {\n            this.createAccount(email, pass);\n          } else if (errorCode) {\n            this.setStateToError(error.message);\n          }\n          this.setStateToLogInInProgress(false);\n        });\n    });\n  }\n\n  createAccount(email, password) {\n    firebaseAuth\n      .signUp(email, password)\n      .then(() => {\n        this.notifyLogInSuccess();\n      })\n      .catch(error => {\n        const errorMessage = error.message;\n        if (errorMessage) {\n          this.setStateToError(errorMessage);\n        } else {\n          this.notifyLogInSuccess();\n        }\n        this.setStateToLogInInProgress(false);\n      });\n  }\n\n  notifyLogInSuccess() {\n    const user = firebaseAuth.currentUser();\n    if (user) {\n      this.props.onUserLoggedIn(new User(user.uid, user.email));\n    }\n  }\n\n  setStateToLogInInProgress(logInInProgress) {\n    this.setState(() => ({\n      isLogInInProgress: logInInProgress\n    }));\n  }\n\n  setStateToError(error) {\n    this.setState(() => ({\n      errorMessage: error\n    }));\n  }\n}\n\nexport default SignInForm;\n","import React, { Component } from \"react\";\nimport SignInForm from \"../baseComponents/signInForm/SignInForm\";\nimport { logOut, saveSession } from \"./actions\";\nimport { withRouter } from \"react-router\";\nimport { connect } from \"react-redux\";\nimport { ALBUM } from \"../app/routes\";\nimport { isUserLoggedIn } from \"./session\";\nimport { Grid, Row, Col } from \"react-flexbox-grid\";\nimport Logo, { mediumSize } from \"../baseComponents/logo/Logo\";\nimport { fade } from \"../animations/animationUtils\";\nimport { Card } from \"material-ui\";\nimport PropTypes from \"prop-types\";\n\nclass LogInScreen extends Component {\n  componentDidMount() {\n    this.goToAlbumScreenIfTheUserIsStillLoggedIn();\n  }\n\n  componentDidUpdate() {\n    this.goToAlbumScreenIfTheUserIsStillLoggedIn();\n  }\n\n  render() {\n    return (\n      <Grid className=\"fullWidth\">\n        <Row center=\"xs\" middle=\"xs\" className=\"fullWidth\">\n          {fade(\n            <Col>\n              <Card>\n                <Logo size={mediumSize} />\n                <SignInForm onUserLoggedIn={this.props.onUserLoggedIn} />\n              </Card>\n            </Col>\n          )}\n        </Row>\n      </Grid>\n    );\n  }\n\n  goToAlbumScreenIfTheUserIsStillLoggedIn() {\n    if (this.props.isUserLoggedIn === true) {\n      this.props.history.push(ALBUM);\n    }\n  }\n}\n\nLogInScreen.propTypes = {\n  onUserLoggedIn: PropTypes.func\n};\n\nconst mapStateToProps = state => {\n  return {\n    isUserLoggedIn: isUserLoggedIn(state)\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onUserLoggedIn: user => {\n      dispatch(saveSession(user));\n    },\n    onError: () => {\n      dispatch(logOut());\n    }\n  };\n};\n\nexport default withRouter(\n  connect(mapStateToProps, mapDispatchToProps)(LogInScreen)\n);\n","import React from \"react\";\nimport { FloatingActionButton } from \"material-ui\";\nimport PropTypes from \"prop-types\";\n\nconst actionButtonStyle = {\n  position: \"fixed\",\n  right: \"0\",\n  bottom: \"0\",\n  margin: \"20px\"\n};\n\nclass FloatingButton extends React.Component {\n  render() {\n    return (\n      <FloatingActionButton\n        style={actionButtonStyle}\n        onClick={this.props.onClick}\n        disabled={this.props.disabled}\n      >\n        {this.props.children}\n      </FloatingActionButton>\n    );\n  }\n}\n\nFloatingButton.propTypes = {\n  onClick: PropTypes.func,\n  disabled: PropTypes.bool\n};\n\nexport default FloatingButton;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { AppBar, Dialog, FlatButton, IconButton } from \"material-ui\";\nimport NavigationArrowBack from \"material-ui/svg-icons/navigation/arrow-back\";\nimport { withRouter } from \"react-router\";\nimport { connect } from \"react-redux\";\nimport { logOut } from \"../../session/actions\";\n\nconst userEmailLabelStyle = {\n  textTransform: \"lowercase\"\n};\n\nclass NavigationBar extends React.Component {\n  constructor(props) {\n    super(props);\n    this.onLeftIconButtonClick = this.onLeftIconButtonClick.bind(this);\n    this.onLogOutButtonClick = this.onLogOutButtonClick.bind(this);\n    this.closeDialog = this.closeDialog.bind(this);\n    this.handleLogOutOkButtonClick = this.handleLogOutOkButtonClick.bind(this);\n    this.state = {\n      showLogOutDialog: false\n    };\n  }\n\n  render() {\n    const logOutDialogActions = [\n      <FlatButton\n        key=\"Cancel button\"\n        label=\"Cancel\"\n        primary={true}\n        onClick={this.closeDialog}\n      />,\n      <FlatButton\n        key=\"Ok button\"\n        label=\"Ok\"\n        primary={true}\n        keyboardFocused={true}\n        onClick={this.handleLogOutOkButtonClick}\n      />\n    ];\n    return (\n      <div>\n        <Dialog\n          title=\"Log Out\"\n          actions={logOutDialogActions}\n          modal={false}\n          open={this.state.showLogOutDialog}\n        >\n          Would you like to close your session?\n        </Dialog>\n        <AppBar\n          title={this.props.title}\n          onLeftIconButtonClick={this.onLeftIconButtonClick}\n          iconElementLeft={this.leftIcon()}\n          showMenuIconButton={this.props.showBackButton || false}\n          iconElementRight={\n            <FlatButton\n              label={this.props.userLoggedInEmail || \" \"}\n              onClick={this.onLogOutButtonClick}\n              labelStyle={userEmailLabelStyle}\n            />\n          }\n        />\n      </div>\n    );\n  }\n\n  leftIcon() {\n    if (this.props.showBackButton) {\n      return (\n        <IconButton>\n          <NavigationArrowBack />\n        </IconButton>\n      );\n    } else {\n      return null;\n    }\n  }\n\n  onLeftIconButtonClick() {\n    if (this.props.showBackButton === true) {\n      this.props.history.goBack();\n    }\n  }\n\n  onLogOutButtonClick() {\n    this.setState({\n      showLogOutDialog: true\n    });\n  }\n\n  closeDialog() {\n    this.setState({ showLogOutDialog: false });\n  }\n\n  handleLogOutOkButtonClick() {\n    this.closeDialog();\n    this.props.handleLogOutOkButtonClick(this.props.history);\n  }\n}\n\nNavigationBar.propTypes = {\n  title: PropTypes.string.isRequired,\n  showBackButton: PropTypes.bool,\n  history: PropTypes.object\n};\n\nconst mapStateToProps = state => {\n  if (state.session && state.session.user) {\n    return {\n      userLoggedInEmail: state.session.user.email\n    };\n  } else {\n    return {};\n  }\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    handleLogOutOkButtonClick: history => {\n      dispatch(logOut(history));\n    }\n  };\n};\n\nexport default withRouter(\n  connect(mapStateToProps, mapDispatchToProps)(NavigationBar)\n);\n","import firebase from \"firebase\";\nimport moment from \"moment\";\n\nexport function uploadBase64Image(folderName, image) {\n  const storageRef = firebase.storage().ref();\n  const timestamp = moment().unix();\n  const fileExtension = \"jpg\";\n  const childRef = storageRef.child(\n    `${folderName}/${timestamp}.${fileExtension}`\n  );\n  return childRef.putString(image, \"data_url\").then(() => {\n    return childRef.getDownloadURL().then(resourceUrl => {\n      const pictureUrl =\n        resourceUrl.substring(\n          0,\n          resourceUrl.indexOf(fileExtension) + fileExtension.length\n        ) + \"?alt=media\";\n      addPictureToTheDatabase(folderName, pictureUrl);\n      return pictureUrl;\n    });\n  });\n}\n\nexport function getPicturesByFolder(folder) {\n  return firebase\n    .database()\n    .ref(`${extractReferenceId(folder)}/pictures/`)\n    .orderByChild(\"createdAt\")\n    .once(\"value\")\n    .then(result => {\n      const firebaseObject = result.val();\n      if (firebaseObject) {\n        return Object.keys(firebaseObject)\n          .map(key => {\n            let storedObject = firebaseObject[key];\n            storedObject.id = key;\n            return storedObject;\n          })\n          .reverse();\n      } else {\n        return [];\n      }\n    });\n}\n\nexport function deletePictureFromFolder(folder, id) {\n  return firebase\n    .database()\n    .ref(`${extractReferenceId(folder)}/pictures/`)\n    .child(id)\n    .remove();\n}\n\nfunction addPictureToTheDatabase(folder, pictureUrl) {\n  const childId = extractReferenceId(folder);\n  const reference = firebase.database().ref(childId);\n  const newKey = reference.child(childId).push().key;\n  let updates = {};\n  updates[\"/pictures/\" + newKey] = {\n    url: pictureUrl,\n    createdAt: moment().valueOf()\n  };\n  return reference.update(updates);\n}\n\nfunction extractReferenceId(folder) {\n  return folder.split(\".\").join(\"\");\n}\n","import { getPicturesByFolder } from \"../firebase/firebaseStorage\";\nimport { getFolderId } from \"../session/session\";\nimport testUtils from \"../testUtils/utils\";\nimport { deletePictureFromFolder } from \"../firebase/firebaseStorage\";\n\nexport const FETCH_PICTURES = \"FETCH_PICTURES\";\nexport const PICTURES_LOADED = \"PICTURES_LOADED\";\nexport const SELECT_PICTURE = \"SELECT_PICTURE\";\nexport const DELETE_PICTURE = \"DELETE_PICTURE\";\nexport const DELETING_PICTURE = \"DELETING_PICTURE\";\n\nexport function fetchPictures() {\n  return function(dispatch, getState) {\n    if (!testUtils.isRunningTests()) {\n      const folderId = getFolderId(getState());\n      if (folderId) {\n        dispatch({\n          type: FETCH_PICTURES,\n          folder: folderId\n        });\n        getPicturesByFolder(folderId).then(pictures => {\n          dispatch({\n            type: PICTURES_LOADED,\n            pictures: pictures\n          });\n        });\n      }\n    }\n  };\n}\n\nexport function selectPicture(pictureSelected) {\n  return {\n    type: SELECT_PICTURE,\n    pictureSelected: pictureSelected\n  };\n}\n\nexport function deletePicture(pictureToDelete) {\n  return function(dispatch, getState) {\n    const folderId = getFolderId(getState());\n    dispatch({\n      type: DELETING_PICTURE\n    });\n    deletePictureFromFolder(folderId, pictureToDelete.id).then(() => {\n      dispatch({\n        type: DELETE_PICTURE,\n        pictureToDelete: pictureToDelete\n      });\n    });\n  };\n}\n","import moment from \"moment\";\n\nexport function formatTimestamp(timestamp) {\n  const jsDate = new Date(timestamp);\n  return moment(jsDate).format(\"MMM Do YYYY\");\n}\n","import React from \"react\";\nimport PhotoCamera from \"material-ui/svg-icons/image/photo-camera\";\n\nconst style = {\n  contentStyle: {\n    height: \"30%\",\n    width: \"90%\",\n    margin: \"auto\"\n  },\n  icon: {\n    height: \"200px\",\n    width: \"200px\",\n    color: \"#828282\"\n  },\n  text: {\n    color: \"#828282\",\n    fontSize: \"110%\"\n  }\n};\n\nclass EmptyAlbum extends React.Component {\n  render() {\n    return (\n      <div style={style.contentStyle}>\n        <PhotoCamera style={style.icon} />\n        <p style={style.text}>\n          Don´t be shy{\" \"}\n          <span role=\"img\" aria-label=\"Smiley\">\n            &#128515;\n          </span>\n          ️\n        </p>\n        <p style={style.text}>\n          Take your first picture tapping on the bottom right button{\" \"}\n          <span role=\"img\" aria-label=\"Camera\">\n            &#128248;\n          </span>\n        </p>\n      </div>\n    );\n  }\n}\n\nexport default EmptyAlbum;\n","import React, { Component } from \"react\";\nimport { withRouter } from \"react-router\";\nimport PropTypes from \"prop-types\";\nimport FloatingButton from \"../baseComponents/floatingButton/FloatingButton\";\nimport ImageCamera from \"material-ui/svg-icons/image/camera\";\nimport { CAMERA, DETAIL } from \"../app/routes\";\nimport NavigationBar from \"../baseComponents/navigationBar/NavigationBar\";\nimport { fetchPictures, selectPicture } from \"./actions\";\nimport { connect } from \"react-redux\";\nimport ProgressBar from \"../baseComponents/progressBar/ProgressBar\";\nimport GridList from \"material-ui/GridList\";\nimport { GridTile } from \"material-ui\";\nimport { formatTimestamp } from \"../utils/dates\";\nimport { Col, Row } from \"react-flexbox-grid\";\nimport EmptyAlbum from \"./emptyCase/EmptyAlbum\";\nimport { LazyLoadImage } from \"react-lazy-load-image-component\";\n\nconst styles = {\n  gridList: {\n    width: \"100%\",\n    height: \"100%\",\n    overflowY: \"auto\"\n  },\n  img: {\n    minWidth: \"100%\",\n    minHeight: \"100%\",\n    transform: \"translate(-50%, -50%)\",\n    position: \"relative\",\n    left: \"50%\",\n    top: \"50%\"\n  }\n};\nclass AlbumScreen extends Component {\n  constructor(props) {\n    super(props);\n    this.onFloatingButtonClick = this.onFloatingButtonClick.bind(this);\n    this.onPictureClick = this.onPictureClick.bind(this);\n  }\n\n  componentDidMount() {\n    this.props.fetchPictures();\n  }\n\n  render() {\n    const containerStyle =\n      this.props.fetchingPictures || this.props.pictures.length === 0\n        ? { height: \"100%\" }\n        : {};\n    return (\n      <div style={containerStyle}>\n        <NavigationBar title=\"&#128444; Your album\" />\n        {this.renderMainComponent()}\n        <FloatingButton onClick={this.onFloatingButtonClick}>\n          <ImageCamera />\n        </FloatingButton>\n      </div>\n    );\n  }\n\n  renderMainComponent() {\n    if (this.props.fetchingPictures) {\n      return (\n        <Row center=\"xs\" middle=\"xs\" className=\"fullWidth\">\n          <Col xs>\n            <ProgressBar />\n          </Col>\n        </Row>\n      );\n    } else if (this.props.pictures.length > 0) {\n      return (\n        <div>\n          <GridList\n            cols={this.props.numberOfColumns}\n            cellHeight={200}\n            style={styles.gridList}\n          >\n            {this.props.pictures.map(tile => {\n              const url = tile.url;\n              const title = formatTimestamp(tile.createdAt);\n              return (\n                <GridTile key={url} title={title}>\n                  <LazyLoadImage\n                    onClick={() => {\n                      this.onPictureClick(tile);\n                    }}\n                    style={styles.img}\n                    src={url}\n                    alt={title}\n                  />\n                </GridTile>\n              );\n            })}\n          </GridList>\n        </div>\n      );\n    } else {\n      return (\n        <Row center=\"xs\" middle=\"xs\" className=\"fullWidth\">\n          <Col xs>\n            <EmptyAlbum />\n          </Col>\n        </Row>\n      );\n    }\n  }\n\n  onFloatingButtonClick() {\n    enterFullScreen();\n    this.props.history.push(CAMERA);\n  }\n\n  onPictureClick(pictureSelected) {\n    this.props.onPictureClick(pictureSelected);\n    this.props.history.push(DETAIL);\n  }\n}\n\nAlbumScreen.propTypes = {\n  history: PropTypes.object.isRequired,\n  numberOfColumns: PropTypes.number\n};\n\nAlbumScreen.defaultProps = {\n  fetchingPictures: true,\n  numberOfColumns: Number(process.env.REACT_APP_ALBUM_NUMBER_OF_COLUMNS)\n};\n\nconst mapStateToProps = state => {\n  const album = state.album;\n  const session = state.session;\n  if (album && session && session.user) {\n    return {\n      fetchingPictures: album.fetchingPictures || false,\n      pictures: album.pictures || [],\n      sendPictureEmail: session.user.email\n    };\n  } else {\n    return {\n      fetchingPictures: false,\n      pictures: []\n    };\n  }\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    fetchPictures: () => {\n      dispatch(fetchPictures());\n    },\n    onPictureClick: pictureSelected => {\n      dispatch(selectPicture(pictureSelected));\n    }\n  };\n};\n\nexport default withRouter(\n  connect(mapStateToProps, mapDispatchToProps)(AlbumScreen)\n);\n\nfunction enterFullScreen() {\n  if (document.documentElement.requestFullscreen) {\n    document.documentElement.requestFullscreen();\n  } else if (document.documentElement.webkitRequestFullscreen) {\n    document.documentElement.webkitRequestFullscreen();\n  }\n}\n","import React from \"react\";\n\nconst videoStyle = {\n  position: \"fixed\",\n  top: \"50%\",\n  left: \"50%\",\n  height: \"100%\",\n  zIndex: \"-100\",\n  transform: \"translateX(-50%) translateY(-50%) scaleX(-1)\"\n};\n\nclass WebCam extends React.Component {\n  componentDidMount() {\n    const video = this.getVideoTag();\n    navigator.getUserMedia =\n      navigator.getUserMedia ||\n      navigator.webkitGetUserMedia ||\n      navigator.mozGetUserMedia ||\n      navigator.msGetUserMedia ||\n      navigator.oGetUserMedia;\n    var constraints = {\n      audio: false,\n      video: {\n        width: { ideal: 1280 },\n        height: { ideal: 1024 },\n        facingMode: \"user\"\n      }\n    };\n\n    navigator.mediaDevices.enumerateDevices().then(function(devices) {\n      for (let i = 0; i !== devices.length; ++i) {\n        if (devices[i].kind === \"videoinput\") {\n          constraints.deviceId = { exact: devices[i].deviceId };\n        }\n      }\n    });\n\n    navigator.mediaDevices.getUserMedia(constraints).then(stream => {\n      this.localStream = stream;\n      video.srcObject = stream;\n    });\n  }\n\n  componentWillUnmount() {\n    const localStream = this.localStream;\n    if (localStream) {\n      localStream.getTracks()[0].stop();\n      const video = this.getVideoTag();\n      video.pause();\n      video.srcObject = null;\n    }\n  }\n\n  render() {\n    return <video autoPlay=\"true\" id=\"video\" style={videoStyle} />;\n  }\n\n  getVideoTag() {\n    return document.querySelector(\"#video\");\n  }\n\n  takePicture() {\n    const video = this.getVideoTag();\n    const canvas = document.createElement(\"canvas\");\n    canvas.height = video.videoHeight;\n    canvas.width = video.videoWidth;\n    const ctx = canvas.getContext(\"2d\");\n    ctx.scale(-1, 1);\n    ctx.drawImage(video, 0, 0, canvas.width * -1, canvas.height);\n    return canvas.toDataURL();\n  }\n}\n\nexport default WebCam;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport moment from \"moment\";\n\nconst containerStyle = {\n  position: \"absolute\",\n  height: \"100%\",\n  width: \"100%\",\n  background: \"rgba(0, 0, 0, 0.5)\"\n};\nconst counterStyle = {\n  fontSize: \"100pt\",\n  color: \"#FFFFFF\",\n  position: \"absolute\",\n  top: \"50%\",\n  left: \"50%\",\n  transform: \"translateX(-50%) translateY(-50%)\"\n};\nclass Countdown extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = this.initialState();\n  }\n\n  initialState() {\n    return {\n      countdownValue: this.props.countdownSeconds,\n      countdownFinished: false\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.wasTheStartDateConfiguredRecently(prevProps)) {\n      this.setState(this.initialState());\n    }\n    if (this.state.countdownFinished === true) {\n      return;\n    }\n    if (this.shouldStopTheCountdown(prevProps)) {\n      this.setState({\n        countdownValue: 0,\n        countdownFinished: true\n      });\n      this.props.onCountdownFinished();\n    } else {\n      if (this.wasTheStartDateConfiguredRecently(prevProps)) {\n        this.updateCounterValue();\n      }\n      if (this.didStartTheCountdown()) {\n        this.countdownTimer = setTimeout(() => {\n          this.updateCounterValue();\n        }, 1000);\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    clearTimeout(this.countdownTimer);\n  }\n\n  render() {\n    if (this.didStartTheCountdown()) {\n      return (\n        <div style={containerStyle}>\n          <span style={counterStyle}>{this.state.countdownValue}</span>\n        </div>\n      );\n    } else {\n      return null;\n    }\n  }\n\n  didStartTheCountdown() {\n    return (\n      typeof this.props.countdownStartDate !== \"undefined\" &&\n      this.state.countdownFinished === false\n    );\n  }\n\n  wasTheStartDateConfiguredRecently(prevProps) {\n    return (\n      typeof prevProps.countdownStartDate === \"undefined\" &&\n      typeof this.props.countdownStartDate !== \"undefined\"\n    );\n  }\n\n  updateCounterValue() {\n    if (!this.props.countdownStartDate) {\n      return;\n    }\n    const now = moment();\n    const secondsSinceStart = this.props.countdownStartDate.diff(\n      now,\n      \"seconds\"\n    );\n    const countdownValue =\n      this.props.countdownSeconds - Math.abs(secondsSinceStart);\n    this.setState({\n      countdownValue: countdownValue\n    });\n  }\n\n  shouldStopTheCountdown(prevProps) {\n    return (\n      this.state.countdownValue <= 0 &&\n      !this.wasTheStartDateConfiguredRecently(prevProps) &&\n      this.state.countdownFinished === false\n    );\n  }\n}\n\nCountdown.propTypes = {\n  onCountdownFinished: PropTypes.func,\n  countdownSeconds: PropTypes.number,\n  countdownStartDate: PropTypes.object\n};\n\nexport default Countdown;\n","import { uploadBase64Image } from \"../firebase/firebaseStorage\";\nimport { getFolderId } from \"../session/session\";\n\nexport const SAVE_TENTATIVE_PICTURE = \"SAVE_TENTATIVE_PICTURE\";\nexport const UPLOAD_PICTURE = \"UPLOAD_PICTURE\";\nexport const PICTURE_UPLOADED = \"PICTURE_UPLOADED\";\n\nexport function saveTentativePicture(base64Picture) {\n  return {\n    type: SAVE_TENTATIVE_PICTURE,\n    base64Picture: base64Picture\n  };\n}\n\nexport function uploadPicture(base64Picture) {\n  return function(dispatch, getState) {\n    dispatch({\n      type: UPLOAD_PICTURE,\n      base64Picture: base64Picture\n    });\n    const userEmail = getFolderId(getState());\n    uploadBase64Image(userEmail, base64Picture).then(pictureUrl => {\n      dispatch(pictureUploaded(pictureUrl));\n    });\n  };\n}\n\nexport function pictureUploaded(pictureUrl) {\n  return {\n    type: PICTURE_UPLOADED,\n    pictureUrl: pictureUrl\n  };\n}\n","import React, { Component } from \"react\";\nimport { withRouter } from \"react-router\";\nimport PropTypes from \"prop-types\";\nimport FloatingButton from \"../baseComponents/floatingButton/FloatingButton\";\nimport ImageCameraAlt from \"material-ui/svg-icons/image/camera-alt\";\nimport WebCam from \"../baseComponents/webcam/WebCam\";\nimport moment from \"moment\";\nimport Countdown from \"../baseComponents/countdown/Countdown\";\nimport { saveTentativePicture } from \"./actions\";\nimport { connect } from \"react-redux\";\nimport { PREVIEW } from \"../app/routes\";\nimport { fade } from \"../animations/animationUtils\";\nimport NavigationBar from \"../baseComponents/navigationBar/NavigationBar\";\n\nconst containerStyle = {\n  height: \"100%\",\n  width: \"100%\"\n};\nclass CameraScreen extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { width: 0, height: 0 };\n    this.onFloatingButtonClick = this.onFloatingButtonClick.bind(this);\n    this.didStartTheCountdown = this.didStartTheCountdown.bind(this);\n    this.didFinishCountdown = this.didFinishCountdown.bind(this);\n    this.webcamReference = React.createRef();\n  }\n\n  componentDidUpdate(prevProp, prevState) {\n    if (prevState.tentativePicture !== this.state.tentativePicture) {\n      this.props.history.push(PREVIEW);\n    }\n  }\n\n  render() {\n    return fade(\n      <div style={containerStyle}>\n        <NavigationBar title=\"&#128248; Cheeese!\" showBackButton={true} />\n        <div>\n          <WebCam ref={this.webcamReference} />\n          <Countdown\n            countdownSeconds={5}\n            countdownStartDate={this.state.startCountdownDate}\n            onCountdownFinished={this.didFinishCountdown}\n          />\n          <FloatingButton\n            onClick={this.onFloatingButtonClick}\n            disabled={this.didStartTheCountdown()}\n          >\n            <ImageCameraAlt />\n          </FloatingButton>\n        </div>\n      </div>\n    );\n  }\n\n  onFloatingButtonClick() {\n    this.setState({\n      startCountdownDate: moment()\n    });\n  }\n\n  didStartTheCountdown() {\n    return typeof this.state.startCountdownDate !== \"undefined\";\n  }\n\n  didFinishCountdown() {\n    this.setState({ startCountdownDate: undefined });\n    const base64Image = this.webcamReference.current.takePicture();\n    this.props.onPictureTaken(base64Image);\n    this.props.history.push(PREVIEW);\n  }\n}\n\nCameraScreen.propTypes = {\n  history: PropTypes.object.isRequired\n};\n\nconst mapStateToProps = state => {\n  const camera = state.camera;\n  if (camera) {\n    return {\n      tentativePicture: camera.tentativePicture\n    };\n  } else {\n    return {};\n  }\n};\n\nconst mapPropsToDispatch = dispatch => {\n  return {\n    onPictureTaken: picture => {\n      dispatch(saveTentativePicture(picture));\n    }\n  };\n};\n\nexport default withRouter(\n  connect(mapStateToProps, mapPropsToDispatch)(CameraScreen)\n);\n","import React from \"react\";\nimport { withRouter } from \"react-router\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\nimport { uploadPicture } from \"../camera/actions\";\nimport moment from \"moment\";\nimport ProgressBar from \"../baseComponents/progressBar/ProgressBar\";\nimport { Col, Row } from \"react-flexbox-grid\";\nimport { fade } from \"../animations/animationUtils\";\nimport NavigationBar from \"../baseComponents/navigationBar/NavigationBar\";\n\nconst containerStyle = {\n  height: \"100%\"\n};\nconst previewStyle = {\n  position: \"absolute\",\n  top: \"50%\",\n  left: \"50%\",\n  height: \"100%\",\n  transform: \"translateX(-50%) translateY(-50%)\"\n};\n\nclass PreviewScreen extends React.Component {\n  componentDidMount() {\n    this.setState({\n      mountDate: moment(),\n      previewFinished: false\n    });\n  }\n\n  componentDidUpdate() {\n    if (this.props.pictureUploaded && this.state.previewFinished === false) {\n      this.setState({\n        previewFinished: true\n      });\n      const dismissDelay = 3 - moment().diff(this.state.mountDate);\n      let timeoutDelay = Math.max(dismissDelay, 0);\n      setTimeout(() => {\n        this.props.history.goBack();\n      }, timeoutDelay);\n    } else if (this.state.previewFinished === false) {\n      this.uploadPicture();\n    }\n  }\n\n  render() {\n    const src = this.props.tentativePicture || this.props.pictureUploaded;\n    return fade(\n      <div style={containerStyle}>\n        <div>\n          <NavigationBar title=\"&#128515; Uploading your picture\" />\n        </div>\n        <Row center=\"xs\" middle=\"xs\" className=\"fullWidth\">\n          <Col xs>\n            <div>\n              <img alt=\"Preview\" style={previewStyle} src={src} />\n              <ProgressBar />\n            </div>\n          </Col>\n        </Row>\n      </div>\n    );\n  }\n\n  uploadPicture() {\n    const tentativePicture = this.props.tentativePicture;\n    if (tentativePicture) {\n      this.props.uploadPicture(tentativePicture);\n    }\n  }\n}\n\nPreviewScreen.propTypes = {\n  history: PropTypes.object.isRequired\n};\n\nconst mapStateToProps = state => {\n  const camera = state.camera;\n  if (camera) {\n    return {\n      tentativePicture: camera.tentativePicture,\n      pictureUploaded: camera.lastPictureUploaded\n    };\n  } else {\n    return {};\n  }\n};\n\nconst mapPropsToDispatch = dispatch => {\n  return {\n    uploadPicture: picture => {\n      dispatch(uploadPicture(picture));\n    }\n  };\n};\nexport default withRouter(\n  connect(mapStateToProps, mapPropsToDispatch)(PreviewScreen)\n);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport \"slick-carousel/slick/slick.css\";\nimport \"slick-carousel/slick/slick-theme.css\";\nimport { withRouter } from \"react-router\";\nimport { connect } from \"react-redux\";\nimport NavigationBar from \"../baseComponents/navigationBar/NavigationBar\";\nimport { formatTimestamp } from \"../utils/dates\";\nimport { deletePicture, selectPicture } from \"../album/actions\";\nimport ActionDelete from \"material-ui/svg-icons/action/delete\";\nimport FloatingButton from \"../baseComponents/floatingButton/FloatingButton\";\nimport ImageGallery from \"react-image-gallery\";\nimport \"react-image-gallery/styles/css/image-gallery.css\";\n\nclass DetailScreen extends React.Component {\n  constructor(props) {\n    super(props);\n    this.updateDimensions = this.updateDimensions.bind(this);\n    this.onNewPictureSelected = this.onNewPictureSelected.bind(this);\n    this.onFloatingButtonClick = this.onFloatingButtonClick.bind(this);\n  }\n  updateDimensions() {\n    this.setState({ width: window.innerWidth, height: window.innerHeight });\n  }\n\n  UNSAFE_componentWillMount() {\n    this.updateDimensions();\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"resize\", this.updateDimensions);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.updateDimensions);\n  }\n\n  componentDidUpdate() {\n    if (this.props.pictures.length === 0) {\n      this.props.history.goBack();\n    }\n  }\n\n  render() {\n    const title = this.props.selectedPicture\n      ? formatTimestamp(this.props.selectedPicture.createdAt)\n      : \"\";\n    const images = this.props.pictures.map(tile => ({ original: tile.url }));\n    return (\n      <div>\n        <NavigationBar title={title} showBackButton={true} />\n        <ImageGallery\n          items={images}\n          lazyLoad={true}\n          showFullscreenButton={false}\n          autoPlay={true}\n          showThumbnails={false}\n          slideInterval={60000}\n          onSlide={index => this.onNewPictureSelected(index)}\n        />\n        <FloatingButton\n          disabled={this.props.deletingPicture}\n          onClick={this.onFloatingButtonClick}\n        >\n          <ActionDelete />\n        </FloatingButton>\n      </div>\n    );\n  }\n\n  settings() {\n    const selectedPicture = this.props.selectedPicture;\n    const selectedIndex = selectedPicture\n      ? this.props.pictures.indexOf(selectedPicture)\n      : 0;\n    return {\n      dots: true,\n      infinite: true,\n      lazyLoad: true,\n      speed: 500,\n      slidesToShow: 1,\n      slidesToScroll: 1,\n      adaptiveHeight: true,\n      autoplay: true,\n      autoplaySpeed: 60000,\n      initialSlide: selectedIndex\n    };\n  }\n\n  onNewPictureSelected(index) {\n    const picture = this.props.pictures[index];\n    this.props.onPictureSelected(picture);\n  }\n\n  onFloatingButtonClick() {\n    const pictureSelected = this.props.selectedPicture;\n    if (pictureSelected) {\n      this.props.onPictureDeleted(pictureSelected);\n    }\n  }\n}\n\nDetailScreen.propTypes = {\n  pictures: PropTypes.array,\n  selectedPicture: PropTypes.object,\n  deletingPicture: PropTypes.bool\n};\n\nDetailScreen.defaultProps = {\n  pictures: [],\n  deletingPicture: false\n};\n\nconst mapStateToProps = state => {\n  const albumState = state.album;\n  return {\n    pictures: albumState.pictures,\n    selectedPicture: albumState.selectedPicture,\n    deletingPicture: albumState.deletingPicture\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onPictureSelected: pictureSelected => {\n      dispatch(selectPicture(pictureSelected));\n    },\n    onPictureDeleted: pictureToDelete => {\n      dispatch(deletePicture(pictureToDelete));\n    }\n  };\n};\n\nexport default withRouter(\n  connect(mapStateToProps, mapDispatchToProps)(DetailScreen)\n);\n","import React, { Component } from \"react\";\nimport SplashScreen from \"../splashScreen/SplashScreen\";\nimport LogInScreen from \"../session/LogInScreen\";\nimport { HashRouter, Route } from \"react-router-dom\";\nimport { ALBUM, CAMERA, DETAIL, INDEX, LOG_IN, PREVIEW } from \"./routes\";\nimport AlbumScreen from \"../album/AlbumScreen\";\nimport \"./css/App.css\";\nimport \"../animations/css/Animations.css\";\nimport CameraScreen from \"../camera/CameraScreen\";\nimport PreviewScreen from \"../preview/PreviewScreen\";\nimport DetailScreen from \"../detail/DetailScreen\";\n\nconst containerStyle = {\n  height: \"100%\"\n};\n\nexport default class App extends Component {\n  render() {\n    return (\n      <HashRouter>\n        <div style={containerStyle}>\n          <Route exact path={INDEX} component={SplashScreen} />\n          <Route exact path={LOG_IN} component={LogInScreen} />\n          <Route exact path={ALBUM} component={AlbumScreen} />\n          <Route exact path={CAMERA} component={CameraScreen} />\n          <Route exact path={PREVIEW} component={PreviewScreen} />\n          <Route exact path={DETAIL} component={DetailScreen} />\n        </div>\n      </HashRouter>\n    );\n  }\n}\n","import store from \"store\";\n\nconst stateKey = \"state\";\n\nexport async function loadState() {\n  return new Promise(resolve => {\n    const savedState = store.get(stateKey) || {};\n    return resolve(savedState);\n  });\n}\n\nexport function saveState(state) {\n  return new Promise(resolve => {\n    store.set(stateKey, state);\n    return resolve(state);\n  });\n}\n\nexport async function reset() {\n  return new Promise(resolve => {\n    store.remove(stateKey);\n    resolve();\n  });\n}\n","import {\n  PICTURE_UPLOADED,\n  SAVE_TENTATIVE_PICTURE,\n  UPLOAD_PICTURE\n} from \"./actions\";\n\nconst initialState = {\n  tentativePicture: undefined,\n  uploadingPicture: false,\n  lastPictureUploaded: undefined\n};\n\nexport function cameraReducer(state = initialState, action) {\n  switch (action.type) {\n    case SAVE_TENTATIVE_PICTURE:\n      return Object.assign({}, state, {\n        tentativePicture: action.base64Picture,\n        lastPictureUploaded: undefined\n      });\n    case UPLOAD_PICTURE:\n      return Object.assign({}, state, {\n        uploadingPicture: true\n      });\n    case PICTURE_UPLOADED:\n      return Object.assign({}, state, {\n        uploadingPicture: false,\n        tentativePicture: undefined,\n        lastPictureUploaded: action.pictureUrl\n      });\n    default:\n      return state;\n  }\n}\n","import {\n  DELETE_PICTURE,\n  DELETING_PICTURE,\n  FETCH_PICTURES,\n  PICTURES_LOADED,\n  SELECT_PICTURE\n} from \"./actions\";\n\nconst initialState = {\n  fetchingPictures: false,\n  deletingPicture: false,\n  pictures: []\n};\n\nexport function albumReducer(state = initialState, action) {\n  switch (action.type) {\n    case FETCH_PICTURES:\n      return Object.assign({}, state, {\n        fetchingPictures: true\n      });\n    case PICTURES_LOADED:\n      return Object.assign({}, state, {\n        fetchingPictures: false,\n        pictures: action.pictures\n      });\n    case SELECT_PICTURE:\n      return Object.assign({}, state, {\n        selectedPicture: action.pictureSelected\n      });\n    case DELETING_PICTURE: {\n      return Object.assign({}, state, {\n        deletingPicture: true\n      });\n    }\n    case DELETE_PICTURE:\n      return Object.assign({}, state, {\n        deletingPicture: false,\n        selectedPicture: newSelectedPicture(\n          state.pictures,\n          action.pictureToDelete\n        ),\n        pictures: state.pictures.filter(\n          picture => picture.id !== action.pictureToDelete.id\n        )\n      });\n    default:\n      return state;\n  }\n}\n\nfunction newSelectedPicture(pictures, pictureToDelete) {\n  if (pictures.length === 1) {\n    return undefined;\n  } else {\n    const newSelectedPictureIndex = Math.max(\n      0,\n      pictures.indexOf(pictureToDelete) - 1\n    );\n    return pictures[newSelectedPictureIndex];\n  }\n}\n","import { sessionReducer } from \"../session/session\";\nimport { applyMiddleware, createStore } from \"redux\";\nimport { loadState, saveState } from \"../persistence/storePersistence\";\nimport { throttle } from \"lodash\";\nimport { RESET_STATE, resetState } from \"./actions\";\nimport testUtils from \"../testUtils/utils\";\nimport thunk from \"redux-thunk\";\nimport firebase from \"firebase\";\nimport { cameraReducer } from \"../camera/camera\";\nimport { albumReducer } from \"../album/album\";\n\nconst buzzStore = createStore(\n  buzzReducer,\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__(),\n  applyMiddleware(thunk)\n);\ninitializeFirebase();\nconfigurePersistence(buzzStore);\n\nfunction configurePersistence(store) {\n  if (!testUtils.isRunningTests()) {\n    return loadInitialState(store).then(() => {\n      configureSubscriberToPersistStateChanges(store);\n    });\n  }\n}\n\nfunction configureSubscriberToPersistStateChanges(store) {\n  const saveNewStatus = () => {\n    const currentState = buzzStore.getState();\n    saveState(currentState);\n  };\n  const persistStateThrottle = 1000;\n  store.subscribe(throttle(saveNewStatus), persistStateThrottle);\n}\n\nfunction loadInitialState(store) {\n  return loadState().then(state => {\n    store.dispatch(resetState(state));\n  });\n}\n\nfunction buzzReducer(state = {}, action) {\n  switch (action.type) {\n    case RESET_STATE:\n      return action.state;\n    default:\n      return {\n        session: sessionReducer(state.session, action),\n        camera: cameraReducer(state.camera, action),\n        album: albumReducer(state.album, action)\n      };\n  }\n}\n\nfunction initializeFirebase() {\n  const config = {\n    apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\n    authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\n    databaseURL: process.env.REACT_APP_FIREBASE_DATABASE_URL,\n    projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\n    storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\n    messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID\n  };\n  if (!testUtils.isRunningTests()) {\n    firebase.initializeApp(config);\n  }\n}\n\nexport default buzzStore;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport MuiThemeProvider from \"material-ui/styles/MuiThemeProvider\";\nimport AppTheme from \"./theme/AppTheme\";\nimport { Provider } from \"react-redux\";\nimport App from \"./app/App\";\nimport buzzStore from \"./app/buzz\";\nimport testUtils from \"./testUtils/utils\";\nimport WebFont from \"webfontloader\";\n\nprepareAppForTestingIfNeeded();\nloadFonts();\n\nReactDOM.render(\n  <Provider store={buzzStore}>\n    <MuiThemeProvider muiTheme={AppTheme}>\n      <App />\n    </MuiThemeProvider>\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\nfunction prepareAppForTestingIfNeeded() {\n  if (testUtils.isRunningTests()) {\n    window.store = buzzStore;\n  }\n}\n\nfunction loadFonts() {\n  WebFont.load({\n    google: {\n      families: [\"Roboto:400\", \"sans-serif\"]\n    }\n  });\n}\n"],"sourceRoot":""}